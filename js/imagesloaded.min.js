(function(){function f(){}function h(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function k(a){return function(){return this[a].apply(this,arguments)}}var d=f.prototype;d.getListeners=function(a){var b=this._getEvents(),c;if("object"===typeof a){var e={};for(c in b)b.hasOwnProperty(c)&&a.test(c)&&(e[c]=b[c])}else e=b[a]||(b[a]=[]);return e};d.flattenListeners=function(a){var b=[],c;for(c=0;c<a.length;c+=1)b.push(a[c].listener);return b};d.getListenersAsObject=function(a){var b=
this.getListeners(a);if(b instanceof Array){var c={};c[a]=b}return c||b};d.addListener=function(a,b){var c=this.getListenersAsObject(a),e="object"===typeof b,g;for(g in c)c.hasOwnProperty(g)&&-1===h(c[g],b)&&c[g].push(e?b:{listener:b,once:!1});return this};d.on=k("addListener");d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})};d.once=k("addOnceListener");d.defineEvent=function(a){this.getListeners(a);return this};d.defineEvents=function(a){for(var b=0;b<a.length;b+=
1)this.defineEvent(a[b]);return this};d.removeListener=function(a,b){var c=this.getListenersAsObject(a),e;for(e in c)if(c.hasOwnProperty(e)){var g=h(c[e],b);-1!==g&&c[e].splice(g,1)}return this};d.off=k("removeListener");d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)};d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)};d.manipulateListeners=function(a,b,c){var e,g,d=a?this.removeListener:this.addListener;a=a?this.removeListeners:this.addListeners;if("object"!==
typeof b||b instanceof RegExp)for(e=c.length;e--;)d.call(this,b,c[e]);else for(e in b)b.hasOwnProperty(e)&&(g=b[e])&&("function"===typeof g?d.call(this,e,g):a.call(this,e,g));return this};d.removeEvent=function(a){var b=typeof a,c=this._getEvents(),e;if("string"===b)delete c[a];else if("object"===b)for(e in c)c.hasOwnProperty(e)&&a.test(e)&&delete c[e];else delete this._events;return this};d.removeAllListeners=k("removeEvent");d.emitEvent=function(a,b){var c=this.getListenersAsObject(a),e,d;for(d in c)if(c.hasOwnProperty(d))for(e=
c[d].length;e--;){var l=c[d][e];!0===l.once&&this.removeListener(a,l.listener);var m=l.listener.apply(this,b||[]);m===this._getOnceReturnValue()&&this.removeListener(a,l.listener)}return this};d.trigger=k("emitEvent");d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)};d.setOnceReturnValue=function(a){this._onceReturnValue=a;return this};d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0};d._getEvents=function(){return this._events||
(this._events={})};"function"===typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return f}):"object"===typeof module&&module.exports?module.exports=f:this.EventEmitter=f}).call(this);
(function(f){var h=document.documentElement,k=function(){};h.addEventListener?k=function(a,b,c){a.addEventListener(b,c,!1)}:h.attachEvent&&(k=function(a,b,c){a[b+c]=c.handleEvent?function(){var a=f.event;a.target=a.target||a.srcElement;c.handleEvent.call(c,a)}:function(){var b=f.event;b.target=b.target||b.srcElement;c.call(a,b)};a.attachEvent("on"+b,a[b+c])});var d=function(){};h.removeEventListener?d=function(a,b,c){a.removeEventListener(b,c,!1)}:h.detachEvent&&(d=function(a,b,c){a.detachEvent("on"+
b,a[b+c]);try{delete a[b+c]}catch(e){a[b+c]=void 0}});h={bind:k,unbind:d};"function"===typeof define&&define.amd?define("eventie/eventie",h):f.eventie=h})(this);
(function(f){function h(a,b){for(var c in b)a[c]=b[c];return a}function k(a){var b=[];if("[object Array]"===e.call(a))b=a;else if("number"===typeof a.length)for(var c=0,d=a.length;c<d;c++)b.push(a[c]);else b.push(a);return b}function d(d,e){function f(b,c,d){if(!(this instanceof f))return new f(b,c);"string"===typeof b&&(b=document.querySelectorAll(b));this.elements=k(b);this.options=h({},this.options);"function"===typeof c?d=c:h(this.options,c);if(d)this.on("always",d);this.getImages();a&&(this.jqDeferred=
new a.Deferred);var e=this;setTimeout(function(){e.check()})}function g(a){this.img=a}f.prototype=new d;f.prototype.options={};f.prototype.getImages=function(){this.images=[];for(var a=0,b=this.elements.length;a<b;a++){var c=this.elements[a];"IMG"===c.nodeName&&this.addImage(c);c=c.querySelectorAll("img");for(var d=0,e=c.length;d<e;d++)this.addImage(c[d])}};f.prototype.addImage=function(a){a=new g(a);this.images.push(a)};f.prototype.check=function(){function a(a,g){d.options.debug&&c&&b.log("confirm",
a,g);d.progress(a);e++;e===f&&d.complete();return!0}var d=this,e=0,f=this.images.length;this.hasAnyBroken=!1;if(f)for(var g=0;g<f;g++){var h=this.images[g];h.on("confirm",a);h.check()}else this.complete()};f.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;var b=this;setTimeout(function(){b.emit("progress",b,a);b.jqDeferred&&b.jqDeferred.notify(b,a)})};f.prototype.complete=function(){var a=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var b=this;setTimeout(function(){b.emit(a,
b);b.emit("always",b);if(b.jqDeferred)b.jqDeferred[b.hasAnyBroken?"reject":"resolve"](b)})};a&&(a.fn.imagesLoaded=function(b,c){return(new f(this,b,c)).jqDeferred.promise(a(this))});var l={};g.prototype=new d;g.prototype.check=function(){var a=l[this.img.src];a?this.useCached(a):(l[this.img.src]=this,this.img.complete&&void 0!==this.img.naturalWidth?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(a=this.proxyImage=new Image,e.bind(a,"load",this),e.bind(a,"error",this),a.src=this.img.src))};
g.prototype.useCached=function(a){if(a.isConfirmed)this.confirm(a.isLoaded,"cached was confirmed");else{var b=this;a.on("confirm",function(a){b.confirm(a.isLoaded,"cache emitted confirmed");return!0})}};g.prototype.confirm=function(a,b){this.isConfirmed=!0;this.isLoaded=a;this.emit("confirm",this,b)};g.prototype.handleEvent=function(a){var b="on"+a.type;if(this[b])this[b](a)};g.prototype.onload=function(){this.confirm(!0,"onload");this.unbindProxyEvents()};g.prototype.onerror=function(){this.confirm(!1,
"onerror");this.unbindProxyEvents()};g.prototype.unbindProxyEvents=function(){e.unbind(this.proxyImage,"load",this);e.unbind(this.proxyImage,"error",this)};return f}var a=f.jQuery,b=f.console,c="undefined"!==typeof b,e=Object.prototype.toString;"function"===typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],d):f.imagesLoaded=d(f.EventEmitter,f.eventie)})(window);